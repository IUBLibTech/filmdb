<% all_here = @cg.all_present? %>
<h4><%= @cg.group_type %> Component Group for <b><i><%= link_to @cg.title.title_text, title_path(@cg.title), target: '_blank' %></i></b></h4>
<% if all_here %>
<p>
  Select physical objects to add to a new Reformatting (MDPI) Component Group. Default scan settings reflect what was set
  for the original Best Copy group. The Reformatting group will assign whatever scan settings are selected when created.
</p>
<% else %>
  <p>A Reformatting Component Group cannot be created. Not all Physical Objects from the Best Copy Component Group are at Best Copy.</p>
<% end %>
<%= form_tag best_copy_selection_update_path, method: :post do %>
<h4>Physical Objects</h4>
<table>
  <tbody>
  <tr>
    <th>IU Barcode</th>
    <th>Gauge</th>
    <th>Generation</th>
    <th>Scan Resolution</th>
    <th>Color Space</th>
    <th>Return on Reel</th>
    <th>Clean</th>
    <th>Select</th>
    <% if !all_here %>
      <th>Location</th>
    <% end %>
  </tr>
  <% @cg.physical_objects.each do |p| %>
  <tr>
    <td><%= p.iu_barcode %></td>
    <td><%= p.gauge %></td>
    <td><%= p.generations_text %></td>
    <td><%= select_tag "component_group[component_group_physical_objects_attributes][#{p.id}][scan_resolution", options_for_select(ComponentGroup::SCAN_RESOLUTIONS.collect{|s| [s, s]}, p.active_scan_settings.scan_resolution) %></td>
    <td><%= select_tag "component_group[component_group_physical_objects_attributes][#{p.id}][color_space]", options_for_select(ComponentGroup::COLOR_SPACES.collect{|s| [s,s]}, p.active_scan_settings.color_space) %></td>
    <td><%= select_tag "component_group[component_group_physical_objects_attributes][#{p.id}][return_on_reel]", options_for_select([["No", false], ["Yes", true]], p.active_scan_settings.return_on_reel) %></td>
    <td><%= select_tag "component_group[component_group_physical_objects_attributes][#{p.id}][clean]", options_for_select(ComponentGroup::CLEAN.collect{|s| [s, s]}, p.active_scan_settings.clean) %></td>
    <% if !all_here %>
      <td>Not all objects are present</td>
      <td><%= p.current_location %></td>
    <% else %>
      <td><%= check_box_tag "component_group[component_group_physical_objects_attributes][#{p.id}][checked]", "", false,  {class: 'po_check'} %></td>
    <% end %>
  </tr>
  <% end %>
  </tbody>
</table>
<% end %>