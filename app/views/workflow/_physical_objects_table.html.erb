<table id="physical_objects_table">
	<tr>
		<th>IU Barcode</th>
		<th>Title(s)</th>
    <th>Status</th>
    <% if action_name == 'pull_request' %>
      <th>Select To Pull</th>
    <% end %>
	</tr>
<% @physical_objects.each do |p| %>
	<tr>
		<td><%=  p.iu_barcode %></td>
		<td><%= p.titles_text %></td>
    <td><%=  p.current_workflow_status.type_and_location %></td>
    <% if action_name == 'pull_request' %>
        <td><%= check_box_tag "po_#{p.id}", ''%></td>
    <% end %>
	</tr>
<% end %>
<% if action_name == 'pull_request' %>
  <tr>
    <td colspan="2">
      <%= form_tag(process_pull_requested_path) do %>
          <%= hidden_field_tag 'ids', '' %>
          <%= submit_tag 'Submit Pull Request' %>
      <% end %>
    </td>
  </tr>
<% end %>
</table>
<% if action_name == 'pull_request' %>
<script type="text/javascript">
  var lastChecked = null;
  $(document).ready(function() {
    $('input:checkbox').click(function(e) {
      if (!lastChecked) {
        lastChecked = this;
	      setChecked();
        return;
      }
      if (e.shiftKey) {
        var start = $('input:checkbox').index(this);
        var end = $('input:checkbox').index(lastChecked);
	      $('input:checkbox').slice(Math.min(start, end), Math.max(start,end) + 1).prop('checked', lastChecked.checked)
      }
      setChecked();
      lastChecked = this;
    });
  })
  // sets the hidden po ids attribute on the form
  function setChecked() {
    var po_ids = [];
    $(':checked').each(function() {
      var x = this;
      po_ids.push(this.id.substring(3))
    });
    $('#ids').val(po_ids.join(','));
  }
</script>
<% end %>