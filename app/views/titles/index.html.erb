<h4>Title Search</h4>
<%= form_tag titles_search_path do %>
<table>
	<tr>
		<th>Title Text</th>
		<td>
			<%= text_field_tag :title_text %>
		</td>
	</tr>
	<tr>
		<th>Date</th>
		<td>
			<%= text_field_tag :date %>
		</td>
	</tr>
	<tr>
		<th>Publisher</th>
		<td>
			<%= text_field_tag :publisher_text %>
		</td>
	</tr>
	<tr>
		<th>Search Within Collection</th>
		<td>
			<%= select_tag :collection_id, options_for_select([['All', "0"]] + Collection.all.order(:name).collect{ |c| [c.name, c.id]}) %>
		</td>
	</tr>
	<tr>
		<td colspan="2">
			<%= submit_tag 'Search' %>
		</td>
	</tr>
</table>
<% end %>

<% if params[:title_text] %>
<h4>Search Results for:</h4>
<table>
	<tr>
		<th>Title Text:</th>
		<td><%= params[:title_text] %></td>
		<th>Date</th>
		<td><%= params[:date] %></td>
		<th>Publisher</th>
		<td><%= params[:publisher_text] %></td>
		<th>Collection:</th>
		<td><%= params[:collection_id] == '0' ? 'All' : "#{Collection.find(params[:collection_id].to_i).name}" %></td>
	</tr>
</table>
<% end %>
<% if @titles %>
<br>
<br>
<table>
	<tr>
		<th>Title</th>
		<th>Date(s)</th>
		<th>Publisher(s)</th>
		<th>Physical Object(s) Summary</th>
	</tr>
	<% @titles.each do |t| %>
	<% c = t.count_selected_for_digitization %>
	<tr class="<%= c > 0 ? 'digitized' : 'not_digitized' %>">
		<td><%= link_to t.title_text, title_path(t) %></td>
		<td>
			<ul>
			<% t.title_dates.each do |td| %>
				<li>
					<b><%= td.date_type %>: <%= td.date_to_s %></b>
				</li>
			<% end %>
			</ul>
		</td>
		<td>
			<ul>
			<% t.title_publishers.each do |tp| %>
				<li>
					<b><%= tp.publisher_type %></b>: <%= tp.name %>
				</li>
			<% end %>
			</ul>
		</td>
		<td>
			<ul>
				<li>
					<b>Physical Object Count</b>: <%= t.physical_objects.size %>
				</li>
				<li>
					<b>Generations</b>: <%= t.physical_objects.collect{ |p| p.humanize_boolean_fields(PhysicalObject::GENERATION_FIELDS) }.flatten.sort.uniq.join(', ') %>
				</li>
				<li>
					<b>Gauges</b>: <%= t.physical_objects.collect{ |p| p.gauge }.uniq.join(', ') %>
				</li>
				<li>
					<b>Physical Objects Selected for Digitization</b>: <%= c %>
				</li>
			</ul>
		</td>
	</tr>
	<% end %>
</table>
<% end %>