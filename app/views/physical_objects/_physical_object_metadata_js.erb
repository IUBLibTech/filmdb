<%#
  This file represents inline javascript necessary for setting up the following behavior on physical object creation and update:
  * barcode validation
  * mediam type menu context switching based on selecting media type
  * autocomplete for title selection
  * autocomplete for series selection
  * accordion hidden fields for collection specific physical object creation (when metadata fields can be omitted)
%>
<script type="text/javascript">
  // hook in validator for the IU barcode field
  $("#physical_object_iu_barcode").bind("change keyup", function () {
    validateIUBarcode($(this));
  });

  // hook in handles for the event change on media type
  var media_type_mediums = <%= PhysicalObject::MEDIA_TYPE_MEDIUMS.to_json.html_safe %>;
  $('#media_type').change(function() {
    media = $("#media_type option:selected").val();
    mediums = media_type_mediums[media];
    $("#medium_types").empty();
    $.each(mediums, function(index, value) {
      $("#medium_types").append($("<option></option>").attr("value", value).text(value));
    });
  });

  // if the collection metadata configuration is in effect
  $( function() {
    $( "#accordion" ).accordion({
      collapsible: true,
      active: false
    });
  });

  // autocomplete for titles
  $('#physical_object_title_text').autocomplete({
    minLength: 2,
    source: '../../../autocomplete_title',
    focus: function (event, ui) {
      $(".ui-autocomplete > li").attr("title", ui.item.description);
      return false;
    },
    select: function (event, ui) {
      $("#physical_object_title_text").val(ui.item.label);
      $('#physical_object_title_id').val(ui.item.value);
      return false;
    }
  })
  // autocomplete for seriese
  $('#physical_object_series_title_text').autocomplete({
    source: '../../../autocomplete_series',
    focus: function (event, ui) {
      $(".ui-autocomplete > li").attr("title", ui.item.description);
      return false;
    },
    select: function (event, ui) {
      $("#physical_object_series_title_text").val(ui.item.label);
      $('#physical_object_series_id').val(ui.item.value);
      return false;
    }
  })

  //autcomplete for collections
  $('#physical_object_collection_text').autocomplete({
    source: '../../../autocomplete_collection',
    focus: function (event, ui) {
      //$(".ui-autocomplete > li").attr("title", ui.item.description);
      return false;
    },
    select: function (event, ui) {
      $("#physical_object_collection_text").val(ui.item.label);
      $('#physical_object_collection_id').val(ui.item.value);
      return false;
    }
  })
</script>
